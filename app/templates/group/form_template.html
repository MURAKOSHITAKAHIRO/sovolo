{% load i18n %}
<div class="form-group">
  <label id="id_name" class="col-sm-3">グループ名</label>
  <div class="col-sm-9">
    <input id="id_name" class="form-control" maxlength="100" name="name" type="text" required=""
           value="{{ group.name }}">
  </div>
</div>

<div class="form-group">
  <label id="id_description" class="col-sm-3">グループの説明</label>
  <div class="col-sm-9">
    <textarea cols="40" class="form-control" id="id_description" name="description" rows="10"
              required="">{{ group.description }}</textarea>
  </div>
</div>

<div class="form-group">
  <label for="id_image" class="col-sm-3">グループ画像</label>
  <div class="col-sm-9">
    <input class="filestyle" id="id_image" name="image" type="file" data-buttonName="btn-primary" data-buttonText="選択..."/>
  </div>
</div>


<div class="form-group">
  <label class="col-sm-3">管理者</label>
  <div class="col-sm-9">
    <div id="admins">
      {% for admin in group.admins %}
        <label><input name="admins" type="checkbox" value="{{ admin.username }}" checked>
          {{ admin.username }}
        </label>
      {% endfor %}
    </div>
    <div class="input-group" id="adder">
      <input class="form-control" type="text" id="admin_name" placeholder="ニックネーム">
      <span class="input-group-btn">
        <button class="btn btn-primary" id="add_admin" type="button">追加</button>
      </span>
    </div>
    <script>
      (function () {
        var admins = document.querySelector("#admins");
        var admin_name = document.querySelector('#admin_name');
        var add_admin = document.querySelector('#add_admin');
        add_admin.addEventListener('click', function (e) {
          if (admin_name.value == "") return;
          var label = document.createElement('label');
          var value = admin_name.value;
          label.innerHTML = "<div class='checkbox'><span><input name='admins' type='checkbox' value=" + value + " checked>" + value + "<\/span><\/div>";
          admin_name.value = "";
          admins.appendChild(label);
        });
      })();
    </script>
  </div>
</div>

<div class="form-group">
  <label class="col-sm-3">ボランティアとの紐づけ</label>
  <div class="col-sm-9">
    <div id="events">
      {% for event in group.event.all %}
      {% if forloop.first %}
        <h4>グループに紐づけされたボランティア</h4>
      {% endif %}
        <label>
          <input type="checkbox" name="events" value="{{ event.id }}" {% if event in group.event.all %}checked{% endif %}>
          <div class="media">
            <div class="media-left">
              <a href="/event/{{event.pk}}">
                <div class="media-object custom_thumbnail list-thumbnail" style="background-image:url({{ event.get_image_url }});"></div>
              </a>
            </div>
            <div class="media-body">
              <div class="event-info pull-left">
                  <div class="media-heading">
                    <a href="/event/{{event.pk}}">
                      <h4>{{event.name}}</h4>
                    </a>
                  </div>
                    <i class="fa fa-calendar" aria-hidden="true"></i>
                    {{event.start_time_format | date:'n/j (D)' }}
                    <i class="fa fa-map-marker" aria-hidden="true"></i>
                    {{event.get_region_kanji}}
                  </div>
              </div>
           </div>
        </label>
      {% endfor %}

      <h4>自分の管理しているボランティア</h4>
      {% for event in request.user.admin_event.all %}
        <label>
          <input type="checkbox" name="events" value="{{ event.id }}" {% if event in group.event.all %}checked{% endif %}>
          <div class="media">
            <div class="media-left">
              <a href="/event/{{event.pk}}">
                <div class="media-object custom_thumbnail list-thumbnail" style="background-image:url({{ event.get_image_url }});"></div>
              </a>
            </div>
            <div class="media-body">
              <div class="event-info pull-left">
                  <div class="media-heading">
                    <a href="/event/{{event.pk}}">
                      <h4>{{event.name}}</h4>
                    </a>
                  </div>
                    <i class="fa fa-calendar" aria-hidden="true"></i>
                    {{event.start_time_format | date:'n/j (D)' }}
                    <i class="fa fa-map-marker" aria-hidden="true"></i>
                    {{event.get_region_kanji}}
                  </div>
              </div>
           </div>
        </label>
      {% empty %}
        <p>管理しているボランティア活動はありません。</p>
      {% endfor %}
    </div>
  </div>
</div>

<style>
  #admins label {
    display: block;
  }

  #events label {
    display: block;
  }
</style>
